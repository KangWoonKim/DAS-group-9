install.packages(sjplot)
install.packages("sjPlot")
library(sjPlot)
#| warning: false
#| message: false
#| echo: false
library(ggplot2)
library(dplyr)
library(moderndive)
library(skimr)
library(kableExtra)
library(gridExtra)
library(gapminder)
library(MASS)
library(knitr)
library(datasets)
library(broom)
library(infer)
library(janitor)
library(tidyr)
library(ISLR)
library(readr)
library(stats)
library(sjPlot)
library(patchwork)
install.packages("sjPlot")
library(sjPlot)
#| warning: false
#| message: false
#| echo: false
data <- read_csv("DAProject1.csv")
data <- na.omit(data)
data$Obese <- as.factor(data$Obese)
data$Sex <- as.factor(data$Sex)
data$Education <- as.factor(data$Education)
data$Veg <- as.factor(data$Veg)
data$Fruit <- as.factor(data$Fruit)
# Chunk 1
#| warning: false
#| message: false
#| echo: false
library(ggplot2)
library(dplyr)
library(moderndive)
library(skimr)
library(kableExtra)
library(gridExtra)
library(gapminder)
library(MASS)
library(knitr)
library(datasets)
library(broom)
library(infer)
library(janitor)
library(tidyr)
library(ISLR)
library(readr)
library(stats)
library(sjPlot)
#| warning: false
#| message: false
#| echo: false
data <- read_csv("DAProject1.csv")
data <- na.omit(data)
data$Obese <- as.factor(data$Obese)
data$Sex <- as.factor(data$Sex)
data$Education <- as.factor(data$Education)
data$Veg <- as.factor(data$Veg)
data$Fruit <- as.factor(data$Fruit)
#| echo: false
#| label: tbl-obesity_by_factors
#| warning: false
#| message: false
#|tab-cap: obesity prevalence of Scotland 2008 to 2012.
obesity_prevalence <- data %>%
group_by(Year) %>%
summarise(Obese_Yes = sum(Obese == "Yes") / n() * 100,
Obese_No = sum(Obese == "No") / n() * 100)
obesity_prevalence_long <- pivot_longer(obesity_prevalence, c("Obese_Yes", "Obese_No"), names_to = "Obesity", values_to = "Percentage")
obesity_Age <- data %>%
group_by(Age) %>%
summarise(Obese_Yes = sum(Obese == "Yes") / n() * 100,
Obese_No = sum(Obese == "No") / n() * 100)
obesity_age_long <- pivot_longer(obesity_Age, c("Obese_Yes", "Obese_No"), names_to = "Obesity", values_to = "Percentage")
obesity_Sex <- data %>%
group_by(Sex) %>%
summarise(Obese_Yes = sum(Obese == "Yes") / n() * 100,
Obese_No = sum(Obese == "No") / n() * 100)
obesity_Sex_long <- pivot_longer(obesity_Sex, c("Obese_Yes", "Obese_No"), names_to = "Obesity", values_to = "Percentage")
obesity_Edu <- data %>%
group_by(Education) %>%
summarise(Obese_Yes = sum(Obese == "Yes") / n() * 100,
Obese_No = sum(Obese == "No") / n() * 100)
obesity_Edu_long <- pivot_longer(obesity_Edu, c("Obese_Yes", "Obese_No"), names_to = "Obesity", values_to = "Percentage")
obesity_Veg <- data %>%
group_by(Veg) %>%
summarise(Obese_Yes = sum(Obese == "Yes") / n() * 100,
Obese_No = sum(Obese == "No") / n() * 100)
obesity_Veg_long <- pivot_longer(obesity_Veg, c("Obese_Yes", "Obese_No"), names_to = "Obesity", values_to = "Percentage")
obesity_Fruit <- data %>%
group_by(Fruit) %>%
summarise(Obese_Yes = sum(Obese == "Yes") / n() * 100,
Obese_No = sum(Obese == "No") / n() * 100)
obesity_Fruit_long <- pivot_longer(obesity_Fruit, c("Obese_Yes", "Obese_No"), names_to = "Obesity", values_to = "Percentage")
obesity_by_year <- data %>%
group_by(Year) %>%
summarise(Obesity_Percentage = mean(Obese == "Yes") * 100)
print(obesity_by_year)
data$Age_Group <- cut(data$Age, breaks=c(0, 18, 30, 40, 50, 60, 70,80,90,Inf), labels=c("0-18", "19-30", "31-40", "41-50", "51-60", "60-70","70-80","80-90","90+"))
obesity_by_age_group <- data %>%
group_by(Age_Group) %>%
summarise(Obesity_Percentage = mean(Obese == "Yes") * 100)
print(obesity_by_age_group)
obesity_by_sex <- data %>%
group_by(Sex) %>%
summarise(Obesity_Percentage = mean(Obese == "Yes") * 100)
print(obesity_by_sex)
obesity_by_education <- data %>%
group_by(Education) %>%
summarise(Obesity_Percentage = mean(Obese == "Yes") * 100)
print(obesity_by_education)
obesity_by_veg <- data %>%
group_by(Veg) %>%
summarise(Obesity_Percentage = mean(Obese == "Yes") * 100)
print(obesity_by_veg)
obesity_by_fruit <- data %>%
group_by(Fruit) %>%
summarise(Obesity_Percentage = mean(Obese == "Yes") * 100)
print(obesity_by_fruit)
#| warning: false
#| message: false
#| echo: false
data <- read_csv("DAProject1.csv")
data <- na.omit(data)
data$Obese <- as.factor(data$Obese)
data$Sex <- as.factor(data$Sex)
data$Education <- as.factor(data$Education)
data$Veg <- as.factor(data$Veg)
data$Fruit <- as.factor(data$Fruit)
#| echo: false
#| label: tbl-obesity_by_factors
#| warning: false
#| message: false
#|tab-cap: obesity prevalence of Scotland 2008 to 2012.
obesity_prevalence <- data %>%
group_by(Year) %>%
summarise(Obese_Yes = sum(Obese == "Yes") / n() * 100,
Obese_No = sum(Obese == "No") / n() * 100)
obesity_prevalence_long <- pivot_longer(obesity_prevalence, c("Obese_Yes", "Obese_No"), names_to = "Obesity", values_to = "Percentage")
obesity_Age <- data %>%
group_by(Age) %>%
summarise(Obese_Yes = sum(Obese == "Yes") / n() * 100,
Obese_No = sum(Obese == "No") / n() * 100)
obesity_age_long <- pivot_longer(obesity_Age, c("Obese_Yes", "Obese_No"), names_to = "Obesity", values_to = "Percentage")
obesity_Sex <- data %>%
group_by(Sex) %>%
summarise(Obese_Yes = sum(Obese == "Yes") / n() * 100,
Obese_No = sum(Obese == "No") / n() * 100)
obesity_Sex_long <- pivot_longer(obesity_Sex, c("Obese_Yes", "Obese_No"), names_to = "Obesity", values_to = "Percentage")
obesity_Edu <- data %>%
group_by(Education) %>%
summarise(Obese_Yes = sum(Obese == "Yes") / n() * 100,
Obese_No = sum(Obese == "No") / n() * 100)
obesity_Edu_long <- pivot_longer(obesity_Edu, c("Obese_Yes", "Obese_No"), names_to = "Obesity", values_to = "Percentage")
obesity_Veg <- data %>%
group_by(Veg) %>%
summarise(Obese_Yes = sum(Obese == "Yes") / n() * 100,
Obese_No = sum(Obese == "No") / n() * 100)
obesity_Veg_long <- pivot_longer(obesity_Veg, c("Obese_Yes", "Obese_No"), names_to = "Obesity", values_to = "Percentage")
obesity_Fruit <- data %>%
group_by(Fruit) %>%
summarise(Obese_Yes = sum(Obese == "Yes") / n() * 100,
Obese_No = sum(Obese == "No") / n() * 100)
obesity_Fruit_long <- pivot_longer(obesity_Fruit, c("Obese_Yes", "Obese_No"), names_to = "Obesity", values_to = "Percentage")
obesity_by_year <- data %>%
group_by(Year) %>%
summarise(Obesity_Percentage = mean(Obese == "Yes") * 100)
print(obesity_by_year)
data$Age_Group <- cut(data$Age, breaks=c(0, 18, 30, 40, 50, 60, 70,80,90,Inf), labels=c("0-18", "19-30", "31-40", "41-50", "51-60", "60-70","70-80","80-90","90+"))
obesity_by_age_group <- data %>%
group_by(Age_Group) %>%
summarise(Obesity_Percentage = mean(Obese == "Yes") * 100)
print(obesity_by_age_group)
obesity_by_sex <- data %>%
group_by(Sex) %>%
summarise(Obesity_Percentage = mean(Obese == "Yes") * 100)
print(obesity_by_sex)
obesity_by_education <- data %>%
group_by(Education) %>%
summarise(Obesity_Percentage = mean(Obese == "Yes") * 100)
print(obesity_by_education)
obesity_by_veg <- data %>%
group_by(Veg) %>%
summarise(Obesity_Percentage = mean(Obese == "Yes") * 100)
print(obesity_by_veg)
obesity_by_fruit <- data %>%
group_by(Fruit) %>%
summarise(Obesity_Percentage = mean(Obese == "Yes") * 100)
print(obesity_by_fruit)
#| echo: false
#| label: tbl-obesity_by_factors
#| warning: false
#| message: false
#|tab-cap: obesity prevalence of Scotland 2008 to 2012.
obesity_prevalence <- data %>%
group_by(Year) %>%
summarise(Obese_Yes = sum(Obese == "Yes") / n() * 100,
Obese_No = sum(Obese == "No") / n() * 100)
obesity_prevalence_long <- pivot_longer(obesity_prevalence, c("Obese_Yes", "Obese_No"), names_to = "Obesity", values_to = "Percentage")
obesity_Age <- data %>%
group_by(Age) %>%
summarise(Obese_Yes = sum(Obese == "Yes") / n() * 100,
Obese_No = sum(Obese == "No") / n() * 100)
obesity_age_long <- pivot_longer(obesity_Age, c("Obese_Yes", "Obese_No"), names_to = "Obesity", values_to = "Percentage")
obesity_Sex <- data %>%
group_by(Sex) %>%
summarise(Obese_Yes = sum(Obese == "Yes") / n() * 100,
Obese_No = sum(Obese == "No") / n() * 100)
obesity_Sex_long <- pivot_longer(obesity_Sex, c("Obese_Yes", "Obese_No"), names_to = "Obesity", values_to = "Percentage")
obesity_Edu <- data %>%
group_by(Education) %>%
summarise(Obese_Yes = sum(Obese == "Yes") / n() * 100,
Obese_No = sum(Obese == "No") / n() * 100)
obesity_Edu_long <- pivot_longer(obesity_Edu, c("Obese_Yes", "Obese_No"), names_to = "Obesity", values_to = "Percentage")
obesity_Veg <- data %>%
group_by(Veg) %>%
summarise(Obese_Yes = sum(Obese == "Yes") / n() * 100,
Obese_No = sum(Obese == "No") / n() * 100)
obesity_Veg_long <- pivot_longer(obesity_Veg, c("Obese_Yes", "Obese_No"), names_to = "Obesity", values_to = "Percentage")
obesity_Fruit <- data %>%
group_by(Fruit) %>%
summarise(Obese_Yes = sum(Obese == "Yes") / n() * 100,
Obese_No = sum(Obese == "No") / n() * 100)
obesity_Fruit_long <- pivot_longer(obesity_Fruit, c("Obese_Yes", "Obese_No"), names_to = "Obesity", values_to = "Percentage")
obesity_by_year <- data %>%
group_by(Year) %>%
summarise(Obesity_Percentage = mean(Obese == "Yes") * 100)
print(obesity_by_year)
data$Age_Group <- cut(data$Age, breaks=c(0, 18, 30, 40, 50, 60, 70,80,90,Inf), labels=c("0-18", "19-30", "31-40", "41-50", "51-60", "60-70","70-80","80-90","90+"))
obesity_by_age_group <- data %>%
group_by(Age_Group) %>%
summarise(Obesity_Percentage = mean(Obese == "Yes") * 100)
print(obesity_by_age_group)
obesity_by_sex <- data %>%
group_by(Sex) %>%
summarise(Obesity_Percentage = mean(Obese == "Yes") * 100)
print(obesity_by_sex)
obesity_by_education <- data %>%
group_by(Education) %>%
summarise(Obesity_Percentage = mean(Obese == "Yes") * 100)
print(obesity_by_education)
obesity_by_veg <- data %>%
group_by(Veg) %>%
summarise(Obesity_Percentage = mean(Obese == "Yes") * 100)
print(obesity_by_veg)
obesity_by_fruit <- data %>%
group_by(Fruit) %>%
summarise(Obesity_Percentage = mean(Obese == "Yes") * 100)
print(obesity_by_fruit)
#| echo: false
#| label: tbl-obesity_by_factors
#| warning: false
#| message: false
#|tab-cap: obesity prevalence of Scotland 2008 to 2012.
obesity_prevalence <- data %>%
group_by(Year) %>%
summarise(Obese_Yes = sum(Obese == "Yes") / n() * 100,
Obese_No = sum(Obese == "No") / n() * 100)
obesity_prevalence_long <- pivot_longer(obesity_prevalence, c("Obese_Yes", "Obese_No"), names_to = "Obesity", values_to = "Percentage")
obesity_Age <- data %>%
group_by(Age) %>%
summarise(Obese_Yes = sum(Obese == "Yes") / n() * 100,
Obese_No = sum(Obese == "No") / n() * 100)
obesity_age_long <- pivot_longer(obesity_Age, c("Obese_Yes", "Obese_No"), names_to = "Obesity", values_to = "Percentage")
obesity_Sex <- data %>%
group_by(Sex) %>%
summarise(Obese_Yes = sum(Obese == "Yes") / n() * 100,
Obese_No = sum(Obese == "No") / n() * 100)
obesity_Sex_long <- pivot_longer(obesity_Sex, c("Obese_Yes", "Obese_No"), names_to = "Obesity", values_to = "Percentage")
obesity_Edu <- data %>%
group_by(Education) %>%
summarise(Obese_Yes = sum(Obese == "Yes") / n() * 100,
Obese_No = sum(Obese == "No") / n() * 100)
obesity_Edu_long <- pivot_longer(obesity_Edu, c("Obese_Yes", "Obese_No"), names_to = "Obesity", values_to = "Percentage")
obesity_Veg <- data %>%
group_by(Veg) %>%
summarise(Obese_Yes = sum(Obese == "Yes") / n() * 100,
Obese_No = sum(Obese == "No") / n() * 100)
obesity_Veg_long <- pivot_longer(obesity_Veg, c("Obese_Yes", "Obese_No"), names_to = "Obesity", values_to = "Percentage")
obesity_Fruit <- data %>%
group_by(Fruit) %>%
summarise(Obese_Yes = sum(Obese == "Yes") / n() * 100,
Obese_No = sum(Obese == "No") / n() * 100)
obesity_Fruit_long <- pivot_longer(obesity_Fruit, c("Obese_Yes", "Obese_No"), names_to = "Obesity", values_to = "Percentage")
obesity_by_year <- data %>%
group_by(Year) %>%
summarise(Obesity_Percentage = mean(Obese == "Yes") * 100)
print(obesity_by_year)
data$Age_Group <- cut(data$Age, breaks=c(0, 18, 30, 40, 50, 60, 70,80,90,Inf), labels=c("0-18", "19-30", "31-40", "41-50", "51-60", "60-70","70-80","80-90","90+"))
obesity_by_age_group <- data %>%
group_by(Age_Group) %>%
summarise(Obesity_Percentage = mean(Obese == "Yes") * 100)
print(obesity_by_age_group)
obesity_by_sex <- data %>%
group_by(Sex) %>%
summarise(Obesity_Percentage = mean(Obese == "Yes") * 100)
print(obesity_by_sex)
obesity_by_education <- data %>%
group_by(Education) %>%
summarise(Obesity_Percentage = mean(Obese == "Yes") * 100)
print(obesity_by_education)
obesity_by_veg <- data %>%
group_by(Veg) %>%
summarise(Obesity_Percentage = mean(Obese == "Yes") * 100)
print(obesity_by_veg)
obesity_by_fruit <- data %>%
group_by(Fruit) %>%
summarise(Obesity_Percentage = mean(Obese == "Yes") * 100)
print(obesity_by_fruit)
#| echo: false
#| label: tbl-correlation
#| tbl-cap: "The correlation between Accuracy and Distance"
library(broom)
model_factors <- logistic_reg() |>
set_engine("glm") |>
fit(Obese ~ Age + Sex + Education + Veg + Fruit, data =obesity_by_factors) |>
extract_fit_engine()
model_factors <- logistic_reg() |>
set_engine("glm") |>
fit(Obese ~ Age + Sex + Education + Veg + Fruit, data =obesity_by_factors) |>
extract_fit_engine()
install.packages("broom")
install.packages("broom")
library(broom)
install.packages("tidyverse")
library(tidyverse)
install.packages("broom")
install.packages("broom")
install.packages("tidymodels")
library(tidymodels)
install.packages("sjPlot")
library(sjPlot)
install.packages("sjPlot")
library(sjPlot)
install.packages("sjPlot")
file.remove("/Library/Frameworks/R.framework/Versions/4.1/Resources/library/00LOCK-sjPlot")
install.packages("sjPlot")
library(sjPlot)
#| echo: false
#| label: tbl-obesity_by_factors
#| warning: false
#| message: false
#|tab-cap: obesity prevalence of Scotland 2008 to 2012.
obesity_prevalence <- data %>%
group_by(Year) %>%
summarise(Obese_Yes = sum(Obese == "Yes") / n() * 100,
Obese_No = sum(Obese == "No") / n() * 100)|>
gt()
library(gt)
#| echo: false
#| label: tbl-obesity_by_factors
#| warning: false
#| message: false
#|tab-cap: obesity prevalence of Scotland 2008 to 2012.
obesity_prevalence <- data %>%
group_by(Year) %>%
summarise(Obese_Yes = sum(Obese == "Yes") / n() * 100,
Obese_No = sum(Obese == "No") / n() * 100)|>
gt()
#| warning: false
#| message: false
#| echo: false
library(ggplot2)
library(dplyr)
library(moderndive)
library(skimr)
library(kableExtra)
library(gridExtra)
library(gapminder)
library(MASS)
library(knitr)
library(datasets)
library(broom)
library(infer)
library(janitor)
library(tidyr)
library(ISLR)
library(readr)
library(stats)
library(patchwork)
library(tidymodels)
library(tidymodels)
library(gt)
library(tidyverse)
#| echo: false
#| label: tbl-obesity_by_factors
#| warning: false
#| message: false
#|tab-cap: obesity prevalence of Scotland 2008 to 2012.
obesity_prevalence <- data %>%
group_by(Year) %>%
summarise(Obese_Yes = sum(Obese == "Yes") / n() * 100,
Obese_No = sum(Obese == "No") / n() * 100)|>
gt()
#| echo: false
#| label: tbl-obesity_by_factors
#| warning: false
#| message: false
#|tab-cap: obesity prevalence of Scotland 2008 to 2012.
obesity_prevalence <- data %>%
group_by(Year) %>%
summarise(Obese_Yes = sum(Obese == "Yes") / n() * 100,
Obese_No = sum(Obese == "No") / n() * 100)
#| warning: false
#| message: false
#| echo: false
library(ggplot2)
library(dplyr)
library(moderndive)
library(skimr)
library(kableExtra)
library(gridExtra)
library(gapminder)
library(MASS)
library(knitr)
library(datasets)
library(broom)
library(infer)
library(janitor)
library(tidyr)
library(ISLR)
library(readr)
library(stats)
library(patchwork)
library(tidymodels)
